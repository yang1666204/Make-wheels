<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片懒加载</title>
</head>
<style>
    .imgUnitContainer {
        height: 300px;
        /* 固定一个高度 */
        width: 500px;
        /* 固定一个宽度 */
        overflow: hidden;
        /* 图片超出容器则隐藏 */
        border: 1px solid #eee;
        /* 边框 */
        margin: 10px;
        /* 外边距 */
        display: flex;
        /* 弹性布局 此处主要目的为使图片居中 */
        align-items: center;
        /* 垂直居中 */
        justify-content: center;
        /* 水平居中 */
    }
</style>

<body>
    <div id="container"></div>
</body>
<script>
    //https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg
    var imgNodeList = [];
    (function () {
        var imgUrlArr = [
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "http://icknsd.cn/lanshan/grid.png",
            "http://icknsd.cn/lanshan/todolist.gif",
            "http://icknsd.cn/lanshanimage/one.jpg",
            "http://icknsd.cn/ljfl/blue_ljt.png",
            "http://icknsd.cn/losePic.png",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "http://icknsd.cn/other_lose.png",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
            "https://img.alicdn.com/imgextra/i3/6000000006081/O1CN01DJMY4C1un9Bc41Msv_!!6000000006081-0-octopus.jpg",
        ]
        var innerContainer = document.createElement("div")
        imgUrlArr.forEach(v => {
            var imgUnitContainer = document.createElement("div")
            imgUnitContainer.className = "imgUnitContainer"
            var img = new Image()
            img.src = "https://cdn.jsdelivr.net/gh/sentsin/layui@15d7241/dist/css/modules/layer/default/loading-2.gif"
            img.setAttribute("data-src", v)
            img.setAttribute("loaded", "no")
            imgNodeList.push(img)
            imgUnitContainer.appendChild(img)
            innerContainer.appendChild(imgUnitContainer)
        })
        document.getElementById("container").appendChild(innerContainer)
    })()
    function lazyLoad() {
        var height = window.innerHeight //可视区域高度
        var scrollTop = document.documentElement.scrollTop || document.body.scrollTop
        imgNodeList.forEach(v => {
            if (v.getAttribute("loaded") === 'yes') return
            if ((height + scrollTop) > v.offsetTop) {
                v.setAttribute("loaded", "yes")
                // v.src = v.getAttribute("data-src")
                var tmp = new Image()
                tmp.src = v.getAttribute("data-src")
                tmp.onload = function () {
                    v.src = v.getAttribute("data-src")
                }
            }
        })
    }

    window.onscroll = function () {
        lazyLoad()
    }

    window.onload = function () {
        lazyLoad()
    }
</script>

</html>