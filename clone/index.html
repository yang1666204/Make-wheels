<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        let obj = {
            name: 'a',
            arr: ['red', 'yellow'],
            person: {
                age: 12
            }
        }
        obj.person = obj
        console.log(deepClone(obj));
        //考虑为什么要用WeakMap
        function deepClone(target, hash = new WeakMap) {
            if (typeof target !== 'object' || target === null) {
                return target
            }
            if (hash.has(target)) return target
            let tempObj = Array.isArray(target) ? [] : {}
            hash.set(target, tempObj)
            for (item in target) {
                if (target.hasOwnProperty(item)) {
                    if (typeof item === 'object' && item !== null) {
                        tempObj[item] = deepClone(target[item])
                    } else {
                        tempObj[item] = target[item]
                    }
                }
            }
            return tempObj
        }
    </script>
</body>

</html>